(ns advent-of-code-2018.day02
  (:require [clojure.data :refer [diff]]))

(def input ["cnjxpritdzhubeseewfmqagkul" "cwyxpgitdzhvbosyewfmqagkul" "cnfxpritdzhebosywwfmqagkul" "cnjxpritdzgvbosyawfiqagkul" "cnkxpritdzhvbosyewfmgagkuh" "gnjxprhtdzhebosyewfmqagkul" "cnjxpriedzevbosyewfjqagkul" "cnjxpritdzhpyosyewfsqagkul" "cnjxprltdzhvbosyewfmhagkzl" "cnjxfritdjhvbosyewfmiagkul" "xnjxpritdzhvbosyewfmqagkgn" "cnjxpritdzmvzosyewfhqagkul" "cljxxritdzhvbosyewfmragkul" "cnjxjritdzhvbovyewfmvagkul" "cnjxprdtdzhpbosyewvmqagkul" "cojxprdtdzhzbosyewfmqagkul" "cnjxpritgzhvfgsyewfmqagkul" "knjxprptdzhvbosyecfmqagkul" "cnjxpritdzhvbvsyeyfmqagkuc" "cnjxpritdzhvbosvewfmoagjul" "cnjxpritdzhvbosyfwfmbagkjl" "cnjxpjitazhvbosfewfmqagkul" "cnjtpfitdzhvbosyewfmiagkul" "ckjxpritdzhvbysyewfmqagoul" "cnjxvritdzhvbfsyewfmqalkul" "cnjipqitdzhvbosyewfeqagkul" "cnjhpritdzhvbosyewymqjgkul" "cnjxprrtdzhvbosyewfmlkgkul" "cnjxnritdzhvbopyewfmqaskul" "cxjxpritdzhvtosyewjmqagkul" "cnjxpritdzhvbjsyewfrqagkwl" "cnjxhritdzhubosyewfmqagvul" "cnjxpritdzhvbosyyyfmeagkul" "cnjxkritdzhvaoeyewfmqagkul" "cnjxpritdzhvtotyewfmqazkul" "cnjxoriadzhvbosyewfmqcgkul" "cnjxpritdzhcbosyewfmkapkul" "fnjxprtddzhvbosyewfmqagkul" "cnjxmvitdzhvbosyewfmqagrul" "cnjxpyitdzhibosyewfmqagktl" "cyjxprxtdzhvbosyewbmqagkul" "onjxpditdzhvbosyeofmqagkul" "cnjxprixdzhvbosuewftqagkul" "cnjxpritdrhvaosyewymqagkul" "cnjxpritdzhhbokyewfvqagkul" "cnjxpritczhvbosyewfmqwgxul" "cnjxpribdzqvbnsyewfmqagkul" "ynpxpritdzhvbvsyewfmqagkul" "cnjxprirdzhvboerewfmqagkul" "cnjxpritdxhvbosyewfmgavkul" "cnwxprntdzhvbosyewfmqagkuk" "cnjxpritzzhvbosyewfmcagktl" "bbjxpritdzhvbosyetfmqagkul" "cnjxpbitdzhvbosyewrmqagkui" "cnjxwrildzcvbosyewfmqagkul" "cnqxpoitdzhvbosnewfmqagkul" "cnzxpritdzhvbosyewfmqazkfl" "cnjxpriddzhvoosyewfmhagkul" "znjxpritdzhvbosjewfmqagkur" "cnjxpritdzhvbosyewcmfagkuk" "cnjxpritdzhvbomyywnmqagkul" "cnjxpgitjzhvbosyejfmqagkul" "cnjxpkitdzjvbosyewfmqcgkul" "cnjxpritduhvbosyewfmqfkkul" "cnfxpritdzhvbgsyewfmqwgkul" "cnjxpritdzhvbosywufmqaskul" "cnjxprittzhvboryswfmqagkul" "cndxpritpzrvbosyewfmqagkul" "cnjxpritdzhvbosyewfwqazkum" "cccxprmtdzhvbosyewfmqagkul" "cnjxpzitdzhvlbsyewfmqagkul" "cnjxdrigdzhvbosyewfmqagsul" "fhjxpritdzhvbosyewfmqagkcl" "cnjxpritdzhvdosyewffqagaul" "cnjxprikdztvbosyekfmqagkul" "cnjxpritdzhvbohiewfmqagkue" "cnjxpritdzhvbowyetfmqegkul" "cnuxpritdzhvbosyewmmqapkul" "qnjxpritdzhvbosyewfmjakkul" "cnjxpritdzlvbosyewiaqagkul" "cnjxpritdzhpoosyewfmvagkul" "cdjxpritdzhvboryewfbqagkul" "cnjxppitxzhvbosyewymqagkul" "cnjxpywtdzhvboiyewfmqagkul" "cnjxpritdzpvbosyezfmqaqkul" "cnjppritdghvbosyewfdqagkul" "cmjxpritdzhvbosvewfmqagkup" "cnjxoritdzhvbosylffmqagkul" "cnjxfritdzhvbojyewfmqagkvl" "cnjxpritdzhvbozyewgmqlgkul" "cnjxlritdzhvbosyewfmqalkug" "cnyxprittzhvbosyewfmsagkul" "cnjxprytdzcvdosyewfmqagkul" "ctjxpritdzhvbosyedfmqagkil" "cnjxpvitdzhrbosyewfmqaekul" "cnyxyritdzhvbospewfmqagkul" "cnjxoritwzhvbosyewrmqhgkul" "cnjxpritdzhjbosyqwsmqagkul" "cnjzprindzhvbosyewfmqabkul" "cnjspritdzhvbosysffmqagkul" "cnxxpritdzhvbosyelfmqageul" "bnjhpritdzhvbosyewfmzagkul" "cnjxbhitdzhdbosyewfmqagkul" "cnjxprktdzmvbosyewfmqagkuj" "cnjxprixdzhvbqsyewfmqmgkul" "cnjxpkitdzhvbosyewfmqagbum" "cnjhpritdzhxbosyewfmqagjul" "cnjxpritdzzvbosyewuqqagkul" "cnjxprhtdzhvuopyewfmqagkul" "cnjxpritdzhjqosyewfmqagkgl" "cnzxpritdzhvbosyejfmuagkul" "cnvxpritoohvbosyewfmqagkul" "cnjxpmitdzwvbosyemfmqagkul" "cnjoprittzzvbosyewfmqagkul" "cnjxpgitdzhvbosytwfmqsgkul" "cnjxprrtdehvbosyewfnqagkul" "onjxpjitdzgvbosyewfmqagkul" "cnjxpmitdzhvbopaewfmqagkul" "cnjxpritqzhvbosoewfrqagkul" "cnjxpnitdzhvbosyewfmqagkjy" "cnsxpritdzhvbosyewfmqjykul" "cnjxpriidzhvbosyewfmqxgkut" "cnjxpyitdzhnbosyewfgqagkul" "cnjxpritdzhbboyyewfmqagsul" "cnjxpeitdzsvbosyewfmqabkul" "cnjxpritdzhzvosyewfmragkul" "cnjrpritdzhmbosyewfmqrgkul" "cnjxpritdzhmbosyenfmqaglul" "cnjxqrntdzhvboswewfmqagkul" "cnjxprdtpzhvbosyewfmqagkcl" "cnjxpritdzhvsdsyewfmqagkur" "cnjxpritdzhvvosyewumqhgkul" "cnzxpritdznvhosyewfmqagkul" "ynjypritdzhvbosyewfmqagkuz" "cnjxpnitdzhvbocyezfmqagkul" "vnjxpritdzhvbfsyewfmjagkul" "cnjfpritdzhvbosyewfmqagkzu" "cnjxpritdzhbbosyewfmlegkul" "cnjxpnitdzhvbosyesfmbagkul" "cnjxpritezwvbosyewfmqagkgl" "cujxpritdzhqbosyawfmqagkul" "cnjxprindzhrbosyerfmqagkul" "cntxpritdzhvbosyewfmqauxul" "cnjxpvitdzhvbosyepfmqagkuy" "cnjxdrqtdzhvbosdewfmqagkul" "cnnxpritdzhvvosyenfmqagkul" "lnjxphitdzhvbosyewfaqagkul" "cngxpritdzhhbobyewfmqagkul" "uncxphitdzhvbosyewfmqagkul" "cnjxpribdehvbosfewfmqagkul" "cnjxppitdqhvbmsyewfmqagkul" "gnjxpritkzhvbosyewfbqagkul" "znjxpritdzhvbowycwfmqagkul" "cnjxpgitdzhvbosyewidqagkul" "cnjxhritdzhvbowyswfmqagkul" "injxkritdzhvbjsyewfmqagkul" "cmjupritgzhvbosyewfmqagkul" "cnjxpritdzbvjoeyewfmqagkul" "cnjxpritdkhvbosyewlmuagkul" "cnkxpritdzhebvsyewfmqagkul" "cyjxptitdzhvbosyewfmqagkuv" "cnjxpritdzhvbodrewflqagkul" "cnjxpratdzhvbksyewfhqagkul" "cnjxpoitdzhvbosjewxmqagkul" "cnjxprhidzhvbasyewfmqagkul" "cnjxpritdzhvbosqewvmqagmul" "cnjxoritdzhvbosyzifmqagkul" "mnjxpritdzhvbcsyeyfmqagkul" "cnjhpritgzhvbosyewfmqngkul" "cnjxprijdzevbesyewfmqagkul" "cnexprqtdzhvbosyewvmqagkul" "cnjxpxitdzhvbosyawfmqmgkul" "cnjxpritdzhvbosyirfmqaxkul" "cqjxpcitdzhvboslewfmqagkul" "cmjxpqitdztvbosyewfmqagkul" "cnbxpritdzhvfosyewfmuagkul" "cnjxprrtdzhvbosumwfmqagkul" "cnjxprttdvhvbossewfmqagkul" "cnjxpritdzhvbcsuewfaqagkul" "cbjxpritdzhvbosyewfhqalkul" "cnjxprithzhvbosjcwfmqagkul" "chjxpritdzhvbosyewftcagkul" "cnjxprirdchvdosyewfmqagkul" "cnjxpritdxhvbosyewfmqcgkal" "cnjxpriidchvbosrewfmqagkul" "cnjhprizdzhvbosyewfmqagvul" "cnjwpritdzhpbosyewfmqaqkul" "cnjxpgitfzhvbosyxwfmqagkul" "cnjxpjiedzhvbosywwfmqagkul" "cnjxpritdzhvbosyewfpqynkul" "xnixlritdzhvbosyewfmqagkul" "cnjxoritdznvbosyehfmqagkul" "cnjxpritdzhvbjsyewsmqagcul" "lnjxpritdzhvkosyewjmqagkul" "cnjxpritdzhvbosyedfiqvgkul" "cnjxpritdzhqbdsyerfmqagkul" "cnjxpritdzavbosyywfmqagvul" "dmjxprithzhvbosyewfmqagkul" "cnjxpriqdzhvnosyeofmqagkul" "cnjxpritdxhvboszewfmqkgkul" "cnjxpritdzxvbosjewymqagkul" "cnjxpritdzngbosyewfmqugkul" "cajxpritdnhvbosyerfmqagkul" "cnsxpritdzhvbosymwfmqagcul" "cnjxoritdzhvbosyewrmqhgkul" "cnjxpritdzhvposyewfmqagkwo" "cnjxpriazzhvbosyeufmqagkul" "cnjxrritdzhvbosymhfmqagkul" "cnjxprztdzhvbosyewfmqtgkum" "cnjxpritdzhvbmsyewfmqatkun" "cnuxpritdzhvbosyewfmqagvur" "ctjxxritdzhvbosyewfvqagkul" "cnjxpritdzlvbosyevfmqagkll" "cnjxpritdzhlbosyewfmqagasl" "cnjxpritwzhvbosyewfcxagkul" "cyjxpritdzhfbosyewfmqagcul" "cnjxpritxghvkosyewfmqagkul" "ctjxpritdjhvbosyewfmqkgkul" "cnjxpritxzhvbosyewjmbagkul" "unjxpritdzhkbosyewfmqaghul" "cnjoprqtdzhvbosyewzmqagkul" "rnjxprgtgzhvbosyewfmqagkul" "cnjgpqitdzhvbosyewfaqagkul" "cnjxpritdzuybosyewfmqagful" "cnjxprqtdahvbosyewfnqagkul" "cnjxpritdzhmkhsyewfmqagkul" "wnjxpritdzhvbosiewfmqagkml" "cnjmpritdzhvbosyjwfmqagkdl" "cnjopritdzhvbksyewfmqrgkul" "cnlxpritdzhvbosyewfmomgkul" "cgjxpritdzhvbbsyewfmxagkul" "cnaxpritdvhvnosyewfmqagkul" "cnjxprijdzhvbkmyewfmqagkul" "cnjxpritdzhvposyewzmqagkuz" "cnuxpuitdzdvbosyewfmqagkul" "cnjxprifdzjvbosyewfyqagkul" "cnhspritdzhvbosyewfmqaghul" "cnjxprcbdzfvbosyewfmqagkul" "lnjapritdzhvbosyewfmqegkul" "cnjxprisszhvbosyewqmqagkul" "cnjxpritdzhvbosyeifmsagoul" "cnjxpritrfhvbosyewfmqagkuz" "cnjxkritdzmvboqyewfmqagkul" "cnjxpritdzhvbosyedfmqzgkzl" "cnjxprifdzhvbosyswfmqagksl" "cnjxoritdzhvbosyxwfmhagkul" "cnjhpritdzzvbosfewfmqagkul" "cnjxprityjhvbomyewfmqagkul" "cnjbpritdzhvbosyywfmqagkuf" "cnjxprrtdzhvbosyewgmqagtul"])

(defn solution1 [input]
  (->> input
      (map #(->> %
                 frequencies
                 vals distinct ; "Are there any..?"
                 (filter (fn [x] (> x 1))))) ; We don't care about singles
      (reduce concat) ; we want to view them as a whole
      frequencies vals ; count how many of each
      (reduce *))) ; multiply them for the result

(solution1 input)

; ==========

; O(n^2) :-/
(defn solution2 [input]
  (->> (for [s1 input
             s2 input
             :when (not= s1 s2)] ; we want a cartesian product, but don't care about the diagonal
         (get (diff (seq s1) (seq s2)) 2)) ; calculate the difference, we only want the result of what is equal in both.
       (map #(apply str %)) ;  make them to strings again
       (apply max-key count))) ; choose the longest one. (only works, because all strings are of equal lengths initially.
       ; We could stop at the first, which is exactly one smaller than any string in the input, to not hit the worst case every time

(solution2 input)
